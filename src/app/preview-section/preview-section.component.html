<!-- Preview Section -->
<div class="preview-section" *ngIf="previewData.currentApp">
  <div class="preview-header">
    <h3>
      <span class="emoji">📱</span>
      {{ t("livePreview") }}
      <span *ngIf="isReadOnly" class="read-only-badge">{{
        t("readOnly")
      }}</span>
    </h3>
    <div class="preview-actions" *ngIf="!isReadOnly">
      <button class="action-btn modify" (click)="onModifyClick()">
        <span class="emoji">🔧</span>
        {{ t("modifyApp") }}
      </button>
      <button class="action-btn save" (click)="onSaveClick()">
        <span class="emoji">💾</span>
        {{ t("saveToToolbox") }}
      </button>
      <button class="action-btn clear" (click)="onClearClick()">
        <span class="emoji">🗑️</span>
        {{ t("clear") }}
      </button>
    </div>
  </div>

  <!-- App Store Project Info (only when previewing from App Store) -->
  <div class="app-store-info" *ngIf="isAppStorePreview()">
    <div class="project-info">
      <h4>{{ previewData.sourceProject?.name }}</h4>
      <p class="author">by {{ (previewData.sourceProject?.user?.name || previewData.sourceProject?.user?.username) }}</p>
    </div>
    <div class="star-section">
      <button 
        class="star-btn"
        [class.starred]="previewData.sourceProject?.starred"
        (click)="onStarProject()">
        <span class="star-icon">{{ previewData.sourceProject?.starred ? '⭐' : '☆' }}</span>
        <span class="star-count">{{ previewData.sourceProject?.starCount || 0 }}</span>
      </button>
    </div>
  </div>

  <div class="preview-container">
    <iframe
      [src]="previewData.safePreviewUrl"
      class="preview-frame"
      title="Generated App Preview"
      sandbox="allow-scripts allow-same-origin allow-forms allow-modals allow-popups allow-presentation allow-downloads"
      (load)="onIframeLoad($event)"
      (error)="onIframeError($event)"
    >
    </iframe>
  </div>
</div>
